{"createdAt":"2025-04-21T02:32:07.036Z","updatedAt":"2025-05-12T02:10:47.000Z","id":"BcLRdJU0QIn1UcpJ","name":"[COLO] Slack Bot Slash Command","active":true,"nodes":[{"parameters":{"workflowId":{"__rl":true,"value":"uGqCptWtD45pUJt4","mode":"list","cachedResultName":"[Sub] Get COLO Variables"},"workflowInputs":{"mappingMode":"defineBelow","value":{},"matchingColumns":[],"schema":[],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[620,-340],"id":"bf9544fc-686f-451d-9b43-c0736ad4fbe5","name":"Get COLO Variables"},{"parameters":{"jsCode":"const today = new Date();\nconst formattedDate = `${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›” ${today.getDate()}ì¼`;\n\nconst blocks = [\n  {\n    type: 'header',\n    text: {\n      type: 'plain_text',\n      text: `ğŸ“Š ${$node[\"Slack IN_PROGRESS JIRA  Webhook\"].json.body.text} IN PROGRESS JIRA ì‘ì—… í˜„í™© ë³´ê³  (${formattedDate} ê¸°ì¤€)`,\n      emoji: true\n    }\n  },\n  { type: 'divider' },\n  {\n    type: 'section',\n    text: {\n      type: 'mrkdwn',\n      text: `*ğŸ”¶ ì§„í–‰ ì¤‘ì¸ ì‘ì—… (IN PROGRESS)* - ì´ 0ê±´`\n    }\n  },\n  {\n    type: 'section',\n    text: {\n      type: 'mrkdwn',\n      text: `ğŸ“­ í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤.`\n    }\n  },\n  { type: 'divider' },\n  {\n    type: 'header',\n    text: { type: 'plain_text', text: 'ğŸ“Œ ìš”ì•½', emoji: true }\n  },\n  {\n    type: 'section',\n    fields: [\n      { type: 'mrkdwn', text: `*ì§„í–‰ ì¤‘ ì‘ì—…:*\\n0ê±´` }\n    ]\n  },\n  {\n    type: 'context',\n    elements: [{ type: 'mrkdwn', text: `â±ï¸ ë³´ê³ ì„œ ìƒì„± ì‹œê°„: ${today.toLocaleTimeString()}` }]\n  }\n];\n\nreturn { blocks };"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1280,-240],"id":"3e564347-841c-44a2-98d0-c71080e17d1d","name":"No IN PROGRESS JIRA Issue To Slack Message"},{"parameters":{"jsCode":"const items = $input.all();\nconst JIRA_DOMAIN = $node['Get COLO Variables'].json.jira_domain;\n\n// ì´ëª¨ì§€ ë§¤í•‘\nconst PRIORITY_EMOJI = {\n  Highest: 'ğŸ”´',\n  High: 'ğŸŸ ',\n  Medium: 'ğŸŸ¡',\n  Low: 'ğŸŸ¢',\n  Lowest: 'ğŸ”µ'\n};\n\nconst ISSUE_TYPE_EMOJI = {\n  Bug: 'ğŸ',\n  Story: 'ğŸ“',\n  Task: 'âœ…',\n  Epic: 'ğŸ†',\n  'Sub-task': 'ğŸ“'\n};\n\n// ë‚ ì§œ í¬ë§·\nconst today = new Date();\nconst formattedDate = `${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›” ${today.getDate()}ì¼`;\n\n// ë¸”ë¡ ë°°ì—´\nconst blocks = [];\n\n// ì´ìŠˆ ë¸”ë¡ ìƒì„±\nfunction formatIssueBlock(issue, index) {\n  const type = issue.fields?.issuetype?.name || 'Task';\n  const priority = issue.fields?.priority?.name || 'None';\n  const assignee = issue.fields?.assignee?.displayName || 'Unassigned';\n  const summary = issue.fields?.summary || '(ì œëª© ì—†ìŒ)';\n  let desc = (issue.fields?.description || '').split('\\n')[0]\n    .replace(/\\*|_/g, '')\n    .replace(/\\[.*?\\|.*?$/g, '')\n    .substring(0, 80);\n  const dueDate = issue.fields?.duedate ? `â° *ë§ˆê°ì¼:* ${issue.fields.duedate}` : null;\n\n  const sectionBlock = {\n    type: 'section',\n    text: {\n      type: 'mrkdwn',\n      text: `*${index + 1}.* ${ISSUE_TYPE_EMOJI[type] || 'ğŸ“„'} ${PRIORITY_EMOJI[priority] || 'âšªï¸'} *<${JIRA_DOMAIN}/browse/${issue.key}|${issue.key}>: ${summary}*`\n    }\n  };\n\n  const context = [\n    { type: 'mrkdwn', text: `*ìƒíƒœ:* ${issue.fields?.status?.name || 'ë¯¸ì •'}` },\n    { type: 'mrkdwn', text: `*ìš°ì„ ìˆœìœ„:* ${priority}` },\n    { type: 'mrkdwn', text: `*ë‹´ë‹¹ì:* ${assignee}` }\n  ];\n  if (desc) context.push({ type: 'mrkdwn', text: `ğŸ’¬ ${desc}` });\n  if (dueDate) context.push({ type: 'mrkdwn', text: dueDate });\n\n  return [sectionBlock, { type: 'context', elements: context.slice(0, 10) }, { type: 'divider' }];\n}\n\n// ì´ìŠˆ í•„í„°ë§\nconst allIssues = items.map(item => item.json);\nconst inProgress = allIssues.filter(i => i.fields?.statusCategory?.key === 'indeterminate');\n\n// ë©”ì‹œì§€ êµ¬ì„±\nblocks.push({\n  type: 'header',\n  text: { type: 'plain_text', text: `ğŸ“Š ${$node[\"Slack IN_PROGRESS JIRA  Webhook\"].json.body.text} IN PROGRESS JIRA ì‘ì—… í˜„í™© ë³´ê³  (${formattedDate} ê¸°ì¤€)`, emoji: true }\n});\nblocks.push({ type: 'divider' });\n\nblocks.push({\n  type: 'section',\n  text: { type: 'mrkdwn', text: `*ğŸ”¶ ì§„í–‰ ì¤‘ì¸ ì‘ì—… (IN PROGRESS)* - ì´ ${inProgress.length}ê±´` }\n});\n\ninProgress.forEach((issue, idx) => {\n  const blocksForIssue = formatIssueBlock(issue, idx);\n  blocks.push(...blocksForIssue);\n});\n\nblocks.push(\n  {\n    type: 'header',\n    text: { type: 'plain_text', text: 'ğŸ“Œ ìš”ì•½', emoji: true }\n  },\n  {\n    type: 'section',\n    fields: [\n      { type: 'mrkdwn', text: `*ì§„í–‰ ì¤‘ ì‘ì—…:*\\n${inProgress.length}ê±´` }\n    ]\n  },\n  {\n    type: 'context',\n    elements: [{ type: 'mrkdwn', text: `â±ï¸ ë³´ê³ ì„œ ìƒì„± ì‹œê°„: ${today.toLocaleTimeString()}` }]\n  }\n);\n\nreturn { blocks };"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1280,-440],"id":"829b31a6-18ec-4f22-8715-e6f49d5b5784","name":"IN PROGRESS JIRA Issue To Slack Message"},{"parameters":{"select":"channel","channelId":{"__rl":true,"value":"={{$node[\"Slack IN_PROGRESS JIRA  Webhook\"].json.body.channel_id}}","mode":"id"},"messageType":"block","blocksUi":"={{ $json }}","text":"= ","otherOptions":{}},"type":"n8n-nodes-base.slack","typeVersion":2.3,"position":[1500,-340],"id":"fbee662c-58f9-45e6-a488-1db9132af9d8","name":"IN PROGRESS JIRA SLACK","webhookId":"9fe89c7c-b2e2-4562-8c45-c603b997a890","credentials":{"slackApi":{"id":"Bqw9EwOIkH7skn99","name":"PMS BOT"}}},{"parameters":{"httpMethod":"POST","path":"=jira-in-progress","options":{"responseData":""}},"id":"81c2a3ac-e9fc-44bd-af4a-fc5a8fd4f851","name":"Slack IN_PROGRESS JIRA  Webhook","type":"n8n-nodes-base.webhook","position":[400,-340],"webhookId":"78214945-1731-46ca-a13f-132df9ee1d14","typeVersion":2},{"parameters":{"operation":"getAll","returnAll":true,"options":{"jql":"=assignee = {{ $node[\"Slack IN_PROGRESS JIRA  Webhook\"].json.body.text }} AND issuetype IN (Story, Bug) AND statusCategory = \"In Progress\""}},"name":"Get IN PROGRESS JIRA Issues","type":"n8n-nodes-base.jira","typeVersion":1,"position":[840,-340],"id":"ef9400e9-a4b0-4d37-84b6-dd2ecdda9fc0","alwaysOutputData":true,"credentials":{"jiraSoftwareCloudApi":{"id":"jd9f8LcXIUpGLHG7","name":"Colo Developjik1 Jira SW Cloud account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"d5cfd519-4fee-4455-a8e2-bde82d140131","leftValue":"={{$node[\"Get IN PROGRESS JIRA Issues\"].json}}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1060,-340],"id":"9ce7c6e9-e8d6-400e-824e-dd5e2ca0c2ab","name":"Check IN PROGRESS Issue"},{"parameters":{"content":"## ğŸ“Œ JIRA ì‘ì—… ìƒíƒœ ì¡°íšŒ - Slack Webhook ì•Œë¦¼ ì›Œí¬í”Œë¡œìš°\n\nì´ ì›Œí¬í”Œë¡œìš°ëŠ” Slackì—ì„œ ìˆ˜ì‹ ëœ ë©”ì‹œì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ íŠ¹ì • ì‚¬ìš©ìì˜ JIRA ì´ìŠˆ ì¤‘  \n`IN PROGRESS` ìƒíƒœì¸ ì‘ì—…ë“¤ì„ ì¡°íšŒí•˜ê³ , í•´ë‹¹ ê²°ê³¼ë¥¼ ì‹œê°ì ìœ¼ë¡œ ê°€ê³µí•˜ì—¬  \nSlack ì±„ë„ì— ìë™ìœ¼ë¡œ ì „ì†¡í•˜ëŠ” ìë™í™” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.\n\n---\n\n### ğŸ§© ì›Œí¬í”Œë¡œìš° êµ¬ì„±\n\n- **Slack JIRA IN_PROGRESS Webhook**  \n  Slack ëª…ë ¹ì–´ë¥¼ í†µí•´ ì‚¬ìš©ìëª…ê³¼ ì±„ë„ IDë¥¼ ë°›ì•„ì˜¤ëŠ” Webhook íŠ¸ë¦¬ê±° ë…¸ë“œ  \n  ì˜ˆ: `/jira-in-progress ê¹€ìƒí˜„`\n\n- **Get COLO Variables (Sub Workflow)**  \n  í™˜ê²½ì„¤ì • (ì˜ˆ: JIRA ë„ë©”ì¸) ë“±ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì„œë¸Œ ì›Œí¬í”Œë¡œìš° í˜¸ì¶œ\n\n- **Get IN PROGRESS Jira Issues**  \n  ì…ë ¥ë°›ì€ ì‚¬ìš©ìëª… ê¸°ì¤€ìœ¼ë¡œ `statusCategory = \"In Progress\"` ì¡°ê±´ì˜  \n  JIRA ì´ìŠˆ ëª©ë¡ì„ ì¡°íšŒ (Story, Bug ì´ìŠˆ ëŒ€ìƒ)\n\n- **Check IN PROGRESS ISSUE (IF ë…¸ë“œ)**  \n  ì´ìŠˆ ê²°ê³¼ ìœ ë¬´ë¥¼ íŒë‹¨í•˜ì—¬ ì´í›„ ë©”ì‹œì§€ë¥¼ ë¶„ê¸° ì²˜ë¦¬  \n  - ê²°ê³¼ ìˆìŒ â†’ ìƒì„¸ ì´ìŠˆ í¬ë§· Slack ë©”ì‹œì§€ ìƒì„±  \n  - ê²°ê³¼ ì—†ìŒ â†’ ê³µì§€ ë©”ì‹œì§€ ìƒì„±\n\n- **Jira IN PROGRESS Issue To Slack Message**  \n  ì´ìŠˆê°€ ì¡´ì¬í•  ê²½ìš°, ì´ìŠˆ ì •ë³´ë¥¼ Slack Block í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë…¸ë“œ  \n  ì´ìŠˆ ìƒíƒœ, ìš°ì„ ìˆœìœ„, ë‹´ë‹¹ì, ë§ˆê°ì¼ ë“±ì„ í¬í•¨í•œ ì‹œê°í™”\n\n- **Jira No IN PROGRESS Issue To Slack Message**  \n  ì´ìŠˆê°€ ì—†ì„ ê²½ìš°, 0ê±´ì„ì„ ì•Œë ¤ì£¼ëŠ” ë©”ì‹œì§€ë¥¼ ìƒì„±\n\n- **Slack (ë©”ì‹œì§€ ì „ì†¡)**  \n  Slack ì±„ë„ IDë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ì‹œì§€ ë¸”ë¡ì„ ì „ì†¡\n\n---\n\n### ğŸ§¾ íŠ¹ì§• ë° ì¥ì \n\n- âœ… **Slack ëª…ë ¹ ê¸°ë°˜ ë™ì‘**: ëˆ„êµ¬ë‚˜ ë¹ ë¥´ê²Œ íŠ¹ì • ì‚¬ìš©ì ì´ìŠˆë¥¼ ì¡°íšŒ ê°€ëŠ¥  \n- ğŸ“† **ì‹¤ì‹œê°„ JIRA ì—°ë™**: í˜„ì¬ ìƒíƒœ ê¸°ë°˜ì˜ ì •í™•í•œ ì •ë³´ ì „ë‹¬  \n- ğŸ“Š **ì‹œê°ì  Slack ë³´ê³ ì„œ êµ¬ì„±**: ê°€ë…ì„± ë†’ì€ Block UI í¬ë§·  \n- ğŸš« **ì‘ì—… ì—†ìŒ ì‹œ ì•ˆë‚´ ë©”ì‹œì§€ ì œê³µ**: ë¹„ì–´ìˆì„ ë•Œë„ ì‚¬ìš©ì ê²½í—˜ ê³ ë ¤\n\n---\n\n> ğŸ“£ ì´ ì›Œí¬í”Œë¡œìš°ëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ íŠ¹ì • ì‚¬ìš©ìì˜ ì§„í–‰ ì¤‘ JIRA ìƒíƒœë¥¼ ë³´ê³ í•´ì•¼ í•˜ëŠ”  \n> Slack ê¸°ë°˜ íŒ€ ìš´ì˜ í™˜ê²½ì—ì„œ ë§¤ìš° ìœ ìš©í•©ë‹ˆë‹¤.","height":1460,"width":1560},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[220,-1520],"id":"4b237d81-f8e9-4299-9f9b-06becac6cb0a","name":"Sticky Note"}],"connections":{"Get COLO Variables":{"main":[[{"node":"Get IN PROGRESS JIRA Issues","type":"main","index":0}]]},"No IN PROGRESS JIRA Issue To Slack Message":{"main":[[{"node":"IN PROGRESS JIRA SLACK","type":"main","index":0}]]},"IN PROGRESS JIRA Issue To Slack Message":{"main":[[{"node":"IN PROGRESS JIRA SLACK","type":"main","index":0}]]},"Slack IN_PROGRESS JIRA  Webhook":{"main":[[{"node":"Get COLO Variables","type":"main","index":0}]]},"Get IN PROGRESS JIRA Issues":{"main":[[{"node":"Check IN PROGRESS Issue","type":"main","index":0}]]},"Check IN PROGRESS Issue":{"main":[[{"node":"IN PROGRESS JIRA Issue To Slack Message","type":"main","index":0}],[{"node":"No IN PROGRESS JIRA Issue To Slack Message","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"f00b8d70-d99a-4e3d-81dc-f9e0f25fbc19","triggerCount":1,"tags":[]}