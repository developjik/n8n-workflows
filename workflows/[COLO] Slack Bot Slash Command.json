{"createdAt":"2025-04-21T02:32:07.036Z","updatedAt":"2025-05-12T02:10:47.000Z","id":"BcLRdJU0QIn1UcpJ","name":"[COLO] Slack Bot Slash Command","active":true,"nodes":[{"parameters":{"workflowId":{"__rl":true,"value":"uGqCptWtD45pUJt4","mode":"list","cachedResultName":"[Sub] Get COLO Variables"},"workflowInputs":{"mappingMode":"defineBelow","value":{},"matchingColumns":[],"schema":[],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[620,-340],"id":"bf9544fc-686f-451d-9b43-c0736ad4fbe5","name":"Get COLO Variables"},{"parameters":{"jsCode":"const today = new Date();\nconst formattedDate = `${today.getFullYear()}년 ${today.getMonth() + 1}월 ${today.getDate()}일`;\n\nconst blocks = [\n  {\n    type: 'header',\n    text: {\n      type: 'plain_text',\n      text: `📊 ${$node[\"Slack IN_PROGRESS JIRA  Webhook\"].json.body.text} IN PROGRESS JIRA 작업 현황 보고 (${formattedDate} 기준)`,\n      emoji: true\n    }\n  },\n  { type: 'divider' },\n  {\n    type: 'section',\n    text: {\n      type: 'mrkdwn',\n      text: `*🔶 진행 중인 작업 (IN PROGRESS)* - 총 0건`\n    }\n  },\n  {\n    type: 'section',\n    text: {\n      type: 'mrkdwn',\n      text: `📭 현재 진행 중인 작업이 없습니다.`\n    }\n  },\n  { type: 'divider' },\n  {\n    type: 'header',\n    text: { type: 'plain_text', text: '📌 요약', emoji: true }\n  },\n  {\n    type: 'section',\n    fields: [\n      { type: 'mrkdwn', text: `*진행 중 작업:*\\n0건` }\n    ]\n  },\n  {\n    type: 'context',\n    elements: [{ type: 'mrkdwn', text: `⏱️ 보고서 생성 시간: ${today.toLocaleTimeString()}` }]\n  }\n];\n\nreturn { blocks };"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1280,-240],"id":"3e564347-841c-44a2-98d0-c71080e17d1d","name":"No IN PROGRESS JIRA Issue To Slack Message"},{"parameters":{"jsCode":"const items = $input.all();\nconst JIRA_DOMAIN = $node['Get COLO Variables'].json.jira_domain;\n\n// 이모지 매핑\nconst PRIORITY_EMOJI = {\n  Highest: '🔴',\n  High: '🟠',\n  Medium: '🟡',\n  Low: '🟢',\n  Lowest: '🔵'\n};\n\nconst ISSUE_TYPE_EMOJI = {\n  Bug: '🐞',\n  Story: '📝',\n  Task: '✅',\n  Epic: '🏆',\n  'Sub-task': '📎'\n};\n\n// 날짜 포맷\nconst today = new Date();\nconst formattedDate = `${today.getFullYear()}년 ${today.getMonth() + 1}월 ${today.getDate()}일`;\n\n// 블록 배열\nconst blocks = [];\n\n// 이슈 블록 생성\nfunction formatIssueBlock(issue, index) {\n  const type = issue.fields?.issuetype?.name || 'Task';\n  const priority = issue.fields?.priority?.name || 'None';\n  const assignee = issue.fields?.assignee?.displayName || 'Unassigned';\n  const summary = issue.fields?.summary || '(제목 없음)';\n  let desc = (issue.fields?.description || '').split('\\n')[0]\n    .replace(/\\*|_/g, '')\n    .replace(/\\[.*?\\|.*?$/g, '')\n    .substring(0, 80);\n  const dueDate = issue.fields?.duedate ? `⏰ *마감일:* ${issue.fields.duedate}` : null;\n\n  const sectionBlock = {\n    type: 'section',\n    text: {\n      type: 'mrkdwn',\n      text: `*${index + 1}.* ${ISSUE_TYPE_EMOJI[type] || '📄'} ${PRIORITY_EMOJI[priority] || '⚪️'} *<${JIRA_DOMAIN}/browse/${issue.key}|${issue.key}>: ${summary}*`\n    }\n  };\n\n  const context = [\n    { type: 'mrkdwn', text: `*상태:* ${issue.fields?.status?.name || '미정'}` },\n    { type: 'mrkdwn', text: `*우선순위:* ${priority}` },\n    { type: 'mrkdwn', text: `*담당자:* ${assignee}` }\n  ];\n  if (desc) context.push({ type: 'mrkdwn', text: `💬 ${desc}` });\n  if (dueDate) context.push({ type: 'mrkdwn', text: dueDate });\n\n  return [sectionBlock, { type: 'context', elements: context.slice(0, 10) }, { type: 'divider' }];\n}\n\n// 이슈 필터링\nconst allIssues = items.map(item => item.json);\nconst inProgress = allIssues.filter(i => i.fields?.statusCategory?.key === 'indeterminate');\n\n// 메시지 구성\nblocks.push({\n  type: 'header',\n  text: { type: 'plain_text', text: `📊 ${$node[\"Slack IN_PROGRESS JIRA  Webhook\"].json.body.text} IN PROGRESS JIRA 작업 현황 보고 (${formattedDate} 기준)`, emoji: true }\n});\nblocks.push({ type: 'divider' });\n\nblocks.push({\n  type: 'section',\n  text: { type: 'mrkdwn', text: `*🔶 진행 중인 작업 (IN PROGRESS)* - 총 ${inProgress.length}건` }\n});\n\ninProgress.forEach((issue, idx) => {\n  const blocksForIssue = formatIssueBlock(issue, idx);\n  blocks.push(...blocksForIssue);\n});\n\nblocks.push(\n  {\n    type: 'header',\n    text: { type: 'plain_text', text: '📌 요약', emoji: true }\n  },\n  {\n    type: 'section',\n    fields: [\n      { type: 'mrkdwn', text: `*진행 중 작업:*\\n${inProgress.length}건` }\n    ]\n  },\n  {\n    type: 'context',\n    elements: [{ type: 'mrkdwn', text: `⏱️ 보고서 생성 시간: ${today.toLocaleTimeString()}` }]\n  }\n);\n\nreturn { blocks };"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1280,-440],"id":"829b31a6-18ec-4f22-8715-e6f49d5b5784","name":"IN PROGRESS JIRA Issue To Slack Message"},{"parameters":{"select":"channel","channelId":{"__rl":true,"value":"={{$node[\"Slack IN_PROGRESS JIRA  Webhook\"].json.body.channel_id}}","mode":"id"},"messageType":"block","blocksUi":"={{ $json }}","text":"= ","otherOptions":{}},"type":"n8n-nodes-base.slack","typeVersion":2.3,"position":[1500,-340],"id":"fbee662c-58f9-45e6-a488-1db9132af9d8","name":"IN PROGRESS JIRA SLACK","webhookId":"9fe89c7c-b2e2-4562-8c45-c603b997a890","credentials":{"slackApi":{"id":"Bqw9EwOIkH7skn99","name":"PMS BOT"}}},{"parameters":{"httpMethod":"POST","path":"=jira-in-progress","options":{"responseData":""}},"id":"81c2a3ac-e9fc-44bd-af4a-fc5a8fd4f851","name":"Slack IN_PROGRESS JIRA  Webhook","type":"n8n-nodes-base.webhook","position":[400,-340],"webhookId":"78214945-1731-46ca-a13f-132df9ee1d14","typeVersion":2},{"parameters":{"operation":"getAll","returnAll":true,"options":{"jql":"=assignee = {{ $node[\"Slack IN_PROGRESS JIRA  Webhook\"].json.body.text }} AND issuetype IN (Story, Bug) AND statusCategory = \"In Progress\""}},"name":"Get IN PROGRESS JIRA Issues","type":"n8n-nodes-base.jira","typeVersion":1,"position":[840,-340],"id":"ef9400e9-a4b0-4d37-84b6-dd2ecdda9fc0","alwaysOutputData":true,"credentials":{"jiraSoftwareCloudApi":{"id":"jd9f8LcXIUpGLHG7","name":"Colo Developjik1 Jira SW Cloud account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"d5cfd519-4fee-4455-a8e2-bde82d140131","leftValue":"={{$node[\"Get IN PROGRESS JIRA Issues\"].json}}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1060,-340],"id":"9ce7c6e9-e8d6-400e-824e-dd5e2ca0c2ab","name":"Check IN PROGRESS Issue"},{"parameters":{"content":"## 📌 JIRA 작업 상태 조회 - Slack Webhook 알림 워크플로우\n\n이 워크플로우는 Slack에서 수신된 메시지를 기반으로 특정 사용자의 JIRA 이슈 중  \n`IN PROGRESS` 상태인 작업들을 조회하고, 해당 결과를 시각적으로 가공하여  \nSlack 채널에 자동으로 전송하는 자동화 시스템입니다.\n\n---\n\n### 🧩 워크플로우 구성\n\n- **Slack JIRA IN_PROGRESS Webhook**  \n  Slack 명령어를 통해 사용자명과 채널 ID를 받아오는 Webhook 트리거 노드  \n  예: `/jira-in-progress 김상현`\n\n- **Get COLO Variables (Sub Workflow)**  \n  환경설정 (예: JIRA 도메인) 등을 불러오는 서브 워크플로우 호출\n\n- **Get IN PROGRESS Jira Issues**  \n  입력받은 사용자명 기준으로 `statusCategory = \"In Progress\"` 조건의  \n  JIRA 이슈 목록을 조회 (Story, Bug 이슈 대상)\n\n- **Check IN PROGRESS ISSUE (IF 노드)**  \n  이슈 결과 유무를 판단하여 이후 메시지를 분기 처리  \n  - 결과 있음 → 상세 이슈 포맷 Slack 메시지 생성  \n  - 결과 없음 → 공지 메시지 생성\n\n- **Jira IN PROGRESS Issue To Slack Message**  \n  이슈가 존재할 경우, 이슈 정보를 Slack Block 형식으로 변환하는 노드  \n  이슈 상태, 우선순위, 담당자, 마감일 등을 포함한 시각화\n\n- **Jira No IN PROGRESS Issue To Slack Message**  \n  이슈가 없을 경우, 0건임을 알려주는 메시지를 생성\n\n- **Slack (메시지 전송)**  \n  Slack 채널 ID를 사용하여 메시지 블록을 전송\n\n---\n\n### 🧾 특징 및 장점\n\n- ✅ **Slack 명령 기반 동작**: 누구나 빠르게 특정 사용자 이슈를 조회 가능  \n- 📆 **실시간 JIRA 연동**: 현재 상태 기반의 정확한 정보 전달  \n- 📊 **시각적 Slack 보고서 구성**: 가독성 높은 Block UI 포맷  \n- 🚫 **작업 없음 시 안내 메시지 제공**: 비어있을 때도 사용자 경험 고려\n\n---\n\n> 📣 이 워크플로우는 실시간으로 특정 사용자의 진행 중 JIRA 상태를 보고해야 하는  \n> Slack 기반 팀 운영 환경에서 매우 유용합니다.","height":1460,"width":1560},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[220,-1520],"id":"4b237d81-f8e9-4299-9f9b-06becac6cb0a","name":"Sticky Note"}],"connections":{"Get COLO Variables":{"main":[[{"node":"Get IN PROGRESS JIRA Issues","type":"main","index":0}]]},"No IN PROGRESS JIRA Issue To Slack Message":{"main":[[{"node":"IN PROGRESS JIRA SLACK","type":"main","index":0}]]},"IN PROGRESS JIRA Issue To Slack Message":{"main":[[{"node":"IN PROGRESS JIRA SLACK","type":"main","index":0}]]},"Slack IN_PROGRESS JIRA  Webhook":{"main":[[{"node":"Get COLO Variables","type":"main","index":0}]]},"Get IN PROGRESS JIRA Issues":{"main":[[{"node":"Check IN PROGRESS Issue","type":"main","index":0}]]},"Check IN PROGRESS Issue":{"main":[[{"node":"IN PROGRESS JIRA Issue To Slack Message","type":"main","index":0}],[{"node":"No IN PROGRESS JIRA Issue To Slack Message","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"f00b8d70-d99a-4e3d-81dc-f9e0f25fbc19","triggerCount":1,"tags":[]}