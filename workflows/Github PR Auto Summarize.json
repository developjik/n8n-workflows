{"createdAt":"2025-05-28T02:31:05.778Z","updatedAt":"2025-05-28T05:08:36.000Z","id":"ObJTvu2EtGhRuaCh","name":"Github PR Auto Summarize","active":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[0,0],"id":"89e0284b-a0b8-4d56-a0e6-843ea240547e","name":"When clicking â€˜Test workflowâ€™"},{"parameters":{"workflowId":{"__rl":true,"value":"uGqCptWtD45pUJt4","mode":"list","cachedResultName":"[COLO] (Sub) Get COLO Variables"},"workflowInputs":{"mappingMode":"defineBelow","value":{},"matchingColumns":[],"schema":[],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[220,0],"id":"e4ba683b-ceae-4a87-8b30-c839f71614fb","name":"Execute Workflow"},{"parameters":{"assignments":{"assignments":[{"id":"da025850-15c2-40b9-94d8-e6f37cd46b60","name":"base_branch","value":"dev","type":"string"},{"id":"47966cf5-48cf-445c-967e-abc32d284504","name":"head_branch","value":"feat/PMS-451","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[440,0],"id":"8ce332ae-9bfa-4415-ae5a-22da94ab0c66","name":"Set Variables"},{"parameters":{"promptType":"define","text":"=ë„ˆëŠ” ìˆ™ë ¨ëœ ì†Œí”„íŠ¸ì›¨ì–´ ì—”ì§€ë‹ˆì–´ì´ì ê¸°ìˆ  ì‘ê°€ì•¼. ì£¼ì–´ì§„ GitHub APIì˜ ë¸Œëœì¹˜ ë¹„êµ ê²°ê³¼ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ, ì „ë¬¸ì ì´ê³  ëª…í™•í•œ Pull Request (PR) ë³¸ë¬¸ì„ Markdown í˜•ì‹ìœ¼ë¡œ ìƒì„±í•´ì•¼ í•´.\n\n**ì…ë ¥ ì •ë³´:**\n\n*   **ì†ŒìŠ¤ ë¸Œëœì¹˜ (Source Branch):** `{{ $json.headBranch }}`\n*   **ëŒ€ìƒ ë¸Œëœì¹˜ (Target Branch):** `{{ $json.baseBranch }}`\n*   **GitHub API Compare ì‘ë‹µ ë°ì´í„°:**\n    ```json\n    {{ JSON.stringify($json.githubData, null, 2) }}\n    ```\n\n**PR ë³¸ë¬¸ ìƒì„± ê°€ì´ë“œë¼ì¸:**\n\n1.  **PR ì œëª© (ì„ íƒ ì‚¬í•­):** ì†ŒìŠ¤ ë¸Œëœì¹˜ì—ì„œ ëŒ€ìƒ ë¸Œëœì¹˜ë¡œì˜ ë³‘í•©ì„ì„ ëª…ì‹œí•˜ëŠ” ê°„ê²°í•œ ì œëª©ì„ ì œì•ˆí•´ì¤˜. (ì˜ˆ: `Merge {{ $json.headBranch }} into {{ $json.baseBranch }}`) ì´ ë¶€ë¶„ì€ ìƒëµí•´ë„ ê´œì°®ì•„.\n\n2.  **PR ë³¸ë¬¸ (Markdown í˜•ì‹):** ë‹¤ìŒ ì„¹ì…˜ë“¤ì„ í¬í•¨í•˜ì—¬ ì‘ì„±í•´ì¤˜.\n\n    *   **`## ğŸš€ ë³€ê²½ì‚¬í•­ ìš”ì•½ (Summary)`**\n        *   `{{ $json.headBranch }}` ë¸Œëœì¹˜ì˜ ë³€ê²½ ì‚¬í•­ì„ `{{ $json.baseBranch }}` ë¸Œëœì¹˜ë¡œ ë³‘í•©í•˜ëŠ” PRì„ì„ ëª…ì‹œí•´ì¤˜.\n        *   `githubData.total_commits` ê°’ì„ ì°¸ê³ í•˜ì—¬ ì´ ì»¤ë°‹ ìˆ˜ë¥¼ ì–¸ê¸‰í•´ì¤˜.\n        *   ì „ì²´ ë³€ê²½ ì‚¬í•­ì— ëŒ€í•œ ê°„ëµí•œ ê°œìš”ë¥¼ ì‘ì„±í•´ì¤˜. (AIê°€ `githubData.commits`ì˜ ë©”ì‹œì§€ë‚˜ `githubData.files`ì˜ íŒŒì¼ëª…ì„ ë³´ê³  ì¶”ë¡ )\n\n    *   **`## âœ¨ ì£¼ìš” ë³€ê²½ì  (Key Changes)`**\n        *   `githubData.commits` ì™€ `githubData.files` ë¥¼ ë¶„ì„í•˜ì—¬, ê°€ì¥ ì¤‘ìš”í•˜ê±°ë‚˜ ëˆˆì— ë„ëŠ” ë³€ê²½ ì‚¬í•­ 2-3ê°€ì§€ë¥¼ ê°„ëµí•˜ê²Œ ì„¤ëª…í•´ì¤˜. (ì˜ˆ: \"ìƒˆë¡œìš´ ì‚¬ìš©ì ì¸ì¦ API ì¶”ê°€\", \"ì£¼ë¬¸ ì²˜ë¦¬ ë¡œì§ ê°œì„ \")\n        *   ë§Œì•½ ëª…í™•í•œ ì£¼ìš” ë³€ê²½ì ì„ ì°¾ê¸° ì–´ë µë‹¤ë©´, \"ìƒì„¸ ë³€ê²½ ì‚¬í•­ì€ ì•„ë˜ ì»¤ë°‹ ë° íŒŒì¼ ëª©ë¡ì„ ì°¸ê³ í•´ì£¼ì„¸ìš”.\" ì™€ ê°™ì´ ì‘ì„±í•´ë„ ì¢‹ì•„.\n\n    *   **`## ğŸ“œ ì»¤ë°‹ ëª©ë¡ (Commit Logs)`**\n        *   `githubData.commits` ë°°ì—´ì„ ì‚¬ìš©í•´ì„œ, ê° ì»¤ë°‹ì„ ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ë‚˜ì—´í•´ì¤˜:\n            *   `- {7ìë¦¬ ì¶•ì•½ SHA} - {ì»¤ë°‹ ë©”ì‹œì§€ ì²« ì¤„} (ì‘ì„±ì: {ì»¤ë°‹ ì‘ì„±ì ì´ë¦„})`\n        *   ì»¤ë°‹ì´ ì—†ë‹¤ë©´ \"ìƒˆë¡œìš´ ì»¤ë°‹ì´ ì—†ìŠµë‹ˆë‹¤.\" ë¼ê³  í‘œì‹œí•´ì¤˜.\n\n    *   **`## ğŸ“„ ë³€ê²½ëœ íŒŒì¼ (Changed Files)`**\n        *   `githubData.files` ë°°ì—´ì„ ì‚¬ìš©í•´ì„œ, ê° íŒŒì¼ì„ ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ë‚˜ì—´í•´ì¤˜:\n            *   íŒŒì¼ ìƒíƒœì— ë”°ë¼ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•´ì¤˜:\n                *   `added`: âœ¨ (Added)\n                *   `modified`: â™»ï¸ (Modified)\n                *   `removed`: ğŸ—‘ï¸ (Deleted)\n                *   `renamed`: ğŸšš (Renamed)\n            *   í˜•ì‹: `- {ìƒíƒœ ì´ëª¨í‹°ì½˜} \\`{íŒŒì¼ëª…}\\` (+{ì¶”ê°€ëœ ë¼ì¸ ìˆ˜} -{ì‚­ì œëœ ë¼ì¸ ìˆ˜})`\n        *   ë³€ê²½ëœ íŒŒì¼ì´ ì—†ë‹¤ë©´ \"ë³€ê²½ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.\" ë¼ê³  í‘œì‹œí•´ì¤˜.\n\n    *   **`## ğŸ’¬ ê¸°íƒ€ (Miscellaneous)`**\n        *   (ì´ ë¶€ë¶„ì€ ë¹„ì›Œë‘ê±°ë‚˜, ì‚¬ìš©ìê°€ ì¶”ê°€ ì •ë³´ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆë„ë¡ ì•ˆë‚´ ë¬¸êµ¬ë¥¼ ë„£ì–´ì¤˜. ì˜ˆ: \"- ê´€ë ¨ ì´ìŠˆ: #\\n- í…ŒìŠ¤íŠ¸ í™˜ê²½: \")\n\n**ì£¼ì˜ì‚¬í•­:**\n*   ì»¤ë°‹ ë©”ì‹œì§€ê°€ ë§¤ìš° ê¸¸ ê²½ìš°, ì²« ë²ˆì§¸ ì¤„ë§Œ ì‚¬ìš©í•˜ê±°ë‚˜ ì ì ˆíˆ ìš”ì•½í•´ì¤˜.\n*   ì „ë¬¸ì ì´ê³  ê°„ê²°í•œ ì–´íˆ¬ë¥¼ ì‚¬ìš©í•´ì¤˜.\n*   ë§Œì•½ `githubData`ê°€ ë¹„ì–´ìˆê±°ë‚˜ ë¶„ì„í•  ë‚´ìš©ì´ ì—†ë‹¤ë©´, \"ë³€ê²½ ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.\" ë˜ëŠ” \"ë‘ ë¸Œëœì¹˜ê°€ ë™ì¼í•©ë‹ˆë‹¤.\" ì™€ ê°™ì´ ëª…í™•íˆ ì•Œë ¤ì¤˜.\n\nì´ì œ, ìœ„ì— ì œê³µëœ ì…ë ¥ ì •ë³´ì™€ ê°€ì´ë“œë¼ì¸ì— ë”°ë¼ PR ë³¸ë¬¸ì„ ìƒì„±í•´ì¤˜.","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[1060,0],"id":"bbaf1de9-afaf-4048-8959-73a051c78f7b","name":"AI Agent"},{"parameters":{"jsCode":"const targetBranch = 'main'; // ì˜ˆì‹œ: 'main'\nconst currentBranch ='dev'; // ì˜ˆì‹œ: 'dev'\n\n// GitHub API ì‘ë‹µ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (HTTP Request ë…¸ë“œì˜ ê²°ê³¼)\nconst apiResponse = $input.item.json; // GitHub API ì‘ë‹µ ì „ì²´\n\n// API ì‘ë‹µì´ ë°°ì—´ ì•ˆì— í•˜ë‚˜ì˜ ê°ì²´ë¡œ ë“¤ì–´ìˆìœ¼ë¯€ë¡œ, ì²« ë²ˆì§¸ ìš”ì†Œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\nconst apiData = Array.isArray(apiResponse) && apiResponse.length > 0 ? apiResponse[0] : apiResponse;\n\nlet prBody = `## âœ¨ PR: ${currentBranch} â†’ ${targetBranch}\\n\\n`;\n\nprBody += `### ğŸ“ ìš”ì•½ (Summary)\\n`;\nprBody += `- ì´ PRì€ **${currentBranch}** ë¸Œëœì¹˜ì˜ ë³€ê²½ ì‚¬í•­ì„ **${targetBranch}** ë¸Œëœì¹˜ë¡œ ë³‘í•©í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.\\n`;\nif (apiData && apiData.total_commits) {\n  prBody += `- ì´ **${apiData.total_commits}ê°œ**ì˜ ìƒˆë¡œìš´ ì»¤ë°‹ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\\n`;\n}\nprBody += `\\n`;\n\n// ì»¤ë°‹ ë¡œê·¸ ì„¹ì…˜\nprBody += `### ğŸ“œ ì»¤ë°‹ ë¡œê·¸ (Commit Logs)\\n`;\nif (apiData && apiData.commits && apiData.commits.length > 0) {\n  apiData.commits.forEach(commitEntry => { // API ì‘ë‹µì—ì„œ 'commits' ë°°ì—´ ì‚¬ìš©\n    const shaShort = commitEntry.sha.substring(0, 7);\n    // ì»¤ë°‹ ë©”ì‹œì§€ì˜ ì²« ì¤„ë§Œ ê°€ì ¸ì˜¤ê¸°\n    const messageFirstLine = commitEntry.commit.message.split('\\n')[0];\n    const authorName = commitEntry.commit.author.name;\n    prBody += `- ${shaShort} - ${messageFirstLine} (ì‘ì„±ì: ${authorName})\\n`;\n  });\n} else {\n  prBody += `- ìƒˆë¡œìš´ ì»¤ë°‹ì´ ì—†ìŠµë‹ˆë‹¤.\\n`;\n}\nprBody += `\\n`;\n\n// ë³€ê²½ëœ íŒŒì¼ ì„¹ì…˜\nprBody += `### ğŸ“„ ë³€ê²½ëœ íŒŒì¼ (Changed Files)\\n`;\nif (apiData && apiData.files && apiData.files.length > 0) {\n  apiData.files.forEach(fileEntry => { // API ì‘ë‹µì—ì„œ 'files' ë°°ì—´ ì‚¬ìš©\n    let statusEmoji = '';\n    switch(fileEntry.status) {\n      case 'added': statusEmoji = 'âœ¨ Added'; break;\n      case 'modified': statusEmoji = 'â™»ï¸ Modified'; break;\n      case 'removed': statusEmoji = 'ğŸ—‘ï¸ Deleted'; break;\n      case 'renamed': statusEmoji = 'ğŸšš Renamed'; break;\n      // í•„ìš”ì— ë”°ë¼ ë‹¤ë¥¸ status ê°’ì— ëŒ€í•œ ì²˜ë¦¬ ì¶”ê°€\n      default: statusEmoji = `â“ ${fileEntry.status}`;\n    }\n    prBody += `- ${statusEmoji}: \\`${fileEntry.filename}\\` (+${fileEntry.additions} -${fileEntry.deletions})\\n`;\n  });\n} else {\n  prBody += `- ë³€ê²½ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.\\n`;\n}\nprBody += `\\n`;\n\n// ì‚¬ìš©ìê°€ ì¶”ê°€ì ìœ¼ë¡œ ì‘ì„±í•  ìˆ˜ ìˆëŠ” ì„¹ì…˜ (í…œí”Œë¦¿)\nprBody += `### ğŸ“Œ ì£¼ìš” ë³€ê²½ ì‚¬í•­ (Key Changes)\\n`;\nprBody += `- (ì´ê³³ì— ì´ PRì˜ ì£¼ìš” ë³€ê²½ ì‚¬í•­ì„ ê°„ëµíˆ ì„¤ëª…í•´ì£¼ì„¸ìš”.)\\n\\n`;\n\nprBody += `### âœ… ê¸°íƒ€ (Miscellaneous)\\n`;\nprBody += `- ê´€ë ¨ ì´ìŠˆ: # (ì´ìŠˆ ë²ˆí˜¸ê°€ ìˆë‹¤ë©´ ë§í¬í•˜ì„¸ìš”. ì˜ˆ: #123)\\n`;\nprBody += `- í…ŒìŠ¤íŠ¸ ì™„ë£Œ ì—¬ë¶€: (ì˜ˆ: ì™„ë£Œ / ì§„í–‰ ì¤‘ / í•´ë‹¹ ì—†ìŒ)\\n`;\n\n// ìµœì¢…ì ìœ¼ë¡œ ìƒì„±ëœ PR ë³¸ë¬¸ì„ json ê°ì²´ë¡œ ë°˜í™˜\nreturn [{ json: { prContent: prBody, currentBranch: currentBranch, targetBranch: targetBranch, titleSuggestion: `Merge ${currentBranch} into ${targetBranch}` } }];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[780,-220],"id":"7d630541-ed8f-4a6b-a67d-431ea46c15f2","name":"Code44"},{"parameters":{"jsCode":"const githubData = $('Get Github Compare').item.json;\n\nreturn [{\n  json: {\n    githubData,\n    baseBranch: $('Set Variables').first().json.base_branch,\n    headBranch: $('Set Variables').first().json.head_branch\n  }\n}];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[880,0],"id":"ad9957d5-34ef-4927-bf51-33dc02aa8b9b","name":"Code"},{"parameters":{"url":"=https://api.github.com/repos/colosseumcoinckr/pms-frontend/compare/dev...feat/PMS-451","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Accept","value":"application/vnd.github.v3+json"},{"name":"Authorization","value":"=Bearer {{ $('Execute Workflow').item.json.github_auth }}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[660,0],"id":"dafff484-d223-45df-b003-2561c11c3226","name":"Get Github Compare"},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1-nano","mode":"list","cachedResultName":"gpt-4.1-nano"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[1060,220],"id":"2d66695e-07a3-48dc-a89c-ea7c6cf3389f","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"teZK5ibPNHcUd7eK","name":"Developjik OpenAi account"}}}],"connections":{"When clicking â€˜Test workflowâ€™":{"main":[[{"node":"Execute Workflow","type":"main","index":0}]]},"Execute Workflow":{"main":[[{"node":"Set Variables","type":"main","index":0}]]},"Set Variables":{"main":[[{"node":"Get Github Compare","type":"main","index":0}]]},"Code":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Get Github Compare":{"main":[[{"node":"Code","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"062be6d8-6743-40d8-b4c6-13a8c4a94e9e","triggerCount":0,"tags":[]}